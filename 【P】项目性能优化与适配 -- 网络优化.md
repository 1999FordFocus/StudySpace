## 【P】项目性能优化与适配 -- 网络优化



### 输出倒逼输入

- **有哪些方法能加快网络连接速度**
- 网络连接失败的原因
- 由于网络原因信息发送速度不一，如何使接收端可以确认信息的正确顺序 
- 关于api请求数据劫持 校检正确性问题 网络性能优化的问题
- 当网络带宽足够大，信号足够好，下载大文件，怎么快？
- 【设计】当你的服务商出现问题，设计一个网络请求可用性的兜底方案。

  >   大概从httpDNS，域名容灾等方面回答吧。

- 问网络优化，当网络带宽足够大，信号足够好，下载大文件，怎么快？

  开多个链接，wifi+4G同时，分片下。
  协议层 ，udp去下，本地做完整性校验，我记得qq客户端时这样做的。
  m3u8的思想去下。

开多个链接，wifi+4G同时，分片下。
协议层 ，udp去下，本地做完整性校验，我记得qq客户端时这样做的。
m3u8的思想去下。





### 网络优化

#### DNS优化

传统DNS基于UDP，有诸多缺点：

1. 缓存时间设置得长，域名更新不及时，设置得短，大量 DNS 解析请求影响请求速度; 
2. 域名劫持，容易被中间人攻击，或被运营商劫持，把域名解析到第三方 IP 地址，据统计劫持率会达到7%; 
3. DNS 解析过程不受控制，无法保证解析到最快的IP;
4.  一次请求只能解析一个域名。

优化方案：

​	使用HttpDNS，自己搭建的DNS服务器，比如阿里httpdns、七牛云happy-dns



#### 连接优化

1. keep-alive设置为true，保持长连接。

   okhttp的BridgeInterceptor 中RequestBuilder keep-alive默认为true。

2. 如果服务端支持，那么可以升级到Http 2.0 多路复用，一个连接处理多个请求。

   okhttp3已经支持http2



####  数据压缩

1.  protobuf 采用二进制，比json 数据量更小，序列化速度更快

2. http header中 开启Content-Encodin:gzip



####  其他

1. 使用webp代替png/jpg 

2. 不同网络的不同图片下发，如(对于原图是300x300的图片):

   2/3G使用低清晰度图片:使用100X100的图片; 4G再判断信号强度为强则使用使用300X300的图片，为中等则使用200x200，信号弱则使用100x100图片; WiFi网络:直接下发300X300的图片

3、http开启缓存 / 首页数据加入缓存









































































